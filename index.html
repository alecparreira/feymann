<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Interativo: Construindo o Aprendiz de Feynman</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4A4A4A;
        }
        .nav-link.active {
            color: #D35400;
            font-weight: 700;
        }
        .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .step-content { display: none; }
        .step-content.active { display: block; }
        .step.active div:first-child {
            background-color: #D35400;
            color: white;
        }
        .step.active p {
            font-weight: 700;
            color: #D35400;
        }
        #chat-window .gemini-typing-indicator {
            align-items: center; display: flex; padding-top: 0.5rem;
        }
        #chat-window .gemini-typing-indicator span {
            animation: bounce 1s infinite; background-color: #D35400; border-radius: 50%;
            display: inline-block; height: 8px; margin: 0 2px; width: 8px;
        }
        #chat-window .gemini-typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        #chat-window .gemini-typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }
    </style>
</head>
<body class="antialiased">

    <!-- Header & Navigation -->
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-[#D35400]">Aprendiz de Feynman</h1>
            <div class="hidden md:flex space-x-8">
                <a href="#constituicao" class="nav-link text-gray-600 hover:text-[#D35400] transition">A Constitui√ß√£o</a>
                <a href="#ciclo" class="nav-link text-gray-600 hover:text-[#D35400] transition">O Ciclo</a>
                <a href="#assistente" class="nav-link text-gray-600 hover:text-[#D35400] transition">‚ú® Assistente</a>
                <a href="#simulador" class="nav-link text-gray-600 hover:text-[#D35400] transition">Simulador ao Vivo</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12">
        <!-- Introduction -->
        <section class="text-center mb-24">
            <h2 class="text-4xl md:text-5xl font-bold mb-4">Construindo um Tutor de IA Socr√°tico</h2>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                Este guia interativo destrincha o "Relat√≥rio de Design do Aprendiz de Feynman". Explore os princ√≠pios, o fluxo de conversa√ß√£o e a l√≥gica que permitem a uma IA for√ßar o aprendizado profundo atrav√©s da T√©cnica de Feynman. Agora com o poder da API do Gemini!
            </p>
        </section>

        <!-- Section 1: The Constitution -->
        <section id="constituicao" class="mb-24 scroll-mt-24">
            <h3 class="text-3xl font-bold text-center mb-2">A Constitui√ß√£o do Gem</h3>
            <p class="text-center text-gray-600 mb-12">Os princ√≠pios e regras imut√°veis que governam o comportamento do "Aprendiz de Feynman".</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h4 class="text-xl font-bold mb-3">üìú Persona: Aluno Curioso</h4>
                    <p class="text-gray-600">O Gem incorpora um aluno inteligente, mas totalmente ignorante sobre o tema, for√ßando o utilizador a ser o "Professor". Sua curiosidade √© a ferramenta pedag√≥gica central.</p>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h4 class="text-xl font-bold mb-3">ü•á Primazia da Ignor√¢ncia</h4>
                    <p class="text-gray-600">Regra de ouro n¬∫ 1: O Gem nunca fornece respostas diretas. Ele reflete as perguntas de volta, for√ßando o utilizador a ser a √∫nica fonte de conhecimento.</p>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h4 class="text-xl font-bold mb-3">üîÅ Manuten√ß√£o da Persona</h4>
                    <p class="text-gray-600">A din√¢mica Professor-Aluno √© perp√©tua. O feedback √© sempre enquadrado como uma falha de compreens√£o do Gem, n√£o uma cr√≠tica ao utilizador.</p>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h4 class="text-xl font-bold mb-3">‚ùì Foco no "Porqu√™" e "Como"</h4>
                    <p class="text-gray-600">As perguntas transcendem "o qu√™" para investigar ativamente os mecanismos, as causas e os efeitos por tr√°s das afirma√ß√µes do utilizador.</p>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h4 class="text-xl font-bold mb-3">üëç Refor√ßo Positivo Estrat√©gico</h4>
                    <p class="text-gray-600">Elogia um ponto forte da explica√ß√£o antes de questionar um ponto fraco. Isso diminui a defensividade e mant√©m o utilizador engajado no processo.</p>
                </div>
                <div class="card bg-white p-6 rounded-lg shadow-sm border border-gray-200">
                    <h4 class="text-xl font-bold mb-3">üîé Ca√ßa Ativa ao Jarg√£o</h4>
                    <p class="text-gray-600">Qualquer termo t√©cnico n√£o explicado em linguagem simples √© um alvo priorit√°rio para uma pergunta de clarifica√ß√£o.</p>
                </div>
            </div>
        </section>

        <!-- Section 2: The Cycle -->
        <section id="ciclo" class="mb-24 scroll-mt-24">
            <h3 class="text-3xl font-bold text-center mb-2">O Ciclo de Feynman em A√ß√£o</h3>
            <p class="text-center text-gray-600 mb-12">A intera√ß√£o √© um ciclo iterativo. Clique em cada fase para entender o seu papel no processo de aprendizagem.</p>
            <div class="flex flex-col md:flex-row gap-8 lg:gap-12">
                <div class="w-full md:w-1/3">
                    <div class="space-y-4">
                        <div class="step active cursor-pointer" onclick="showStep(1)"><div class="w-10 h-10 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center font-bold text-lg transition">1</div><p class="mt-2 text-lg font-medium text-gray-700 transition">Inicia√ß√£o</p></div>
                        <div class="step cursor-pointer" onclick="showStep(2)"><div class="w-10 h-10 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center font-bold text-lg transition">2</div><p class="mt-2 text-lg font-medium text-gray-700 transition">Primeira Explica√ß√£o</p></div>
                        <div class="step cursor-pointer" onclick="showStep(3)"><div class="w-10 h-10 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center font-bold text-lg transition">3</div><p class="mt-2 text-lg font-medium text-gray-700 transition">An√°lise e Pergunta</p></div>
                        <div class="step cursor-pointer" onclick="showStep(4)"><div class="w-10 h-10 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center font-bold text-lg transition">4</div><p class="mt-2 text-lg font-medium text-gray-700 transition">Revis√£o e Refinamento</p></div>
                        <div class="step cursor-pointer" onclick="showStep(5)"><div class="w-10 h-10 rounded-full bg-gray-200 text-gray-700 flex items-center justify-center font-bold text-lg transition">5</div><p class="mt-2 text-lg font-medium text-gray-700 transition">Consolida√ß√£o</p></div>
                    </div>
                </div>
                <div class="w-full md:w-2/3 bg-white p-8 rounded-lg shadow-md border border-gray-200">
                    <div id="step-1" class="step-content active"><h4 class="text-2xl font-bold mb-4">Fase 1: Inicia√ß√£o da Sess√£o</h4><p class="text-gray-700 mb-4">O Gem apresenta-se como "Aluno Curioso" e estabelece as regras, definindo o utilizador como "Professor".</p><div class="bg-orange-50 p-4 rounded-lg border border-orange-200"><p class="font-mono text-sm text-orange-800">"Ol√°! A sua miss√£o, 'Professor', √© explicar-me um conceito √† sua escolha de forma t√£o clara que at√© eu consiga entender."</p></div></div>
                    <div id="step-2" class="step-content"><h4 class="text-2xl font-bold mb-4">Fase 2: A Primeira Explica√ß√£o</h4><p class="text-gray-700 mb-4">O utilizador fornece a sua explica√ß√£o inicial. O Gem analisa silenciosamente, identificando jarg√µes e lacunas.</p><div class="bg-blue-50 p-4 rounded-lg border border-blue-200"><p class="font-mono text-sm text-blue-800">"Fant√°stico! Estou pronto e ansioso para aprender. Por favor, explique-me isto como se eu tivesse 5 anos."</p></div></div>
                    <div id="step-3" class="step-content"><h4 class="text-2xl font-bold mb-4">Fase 3: An√°lise Cr√≠tica e Gera√ß√£o de Perguntas</h4><p class="text-gray-700 mb-4">O Gem formula perguntas direcionadas aos pontos fracos, sempre usando refor√ßo positivo primeiro.</p><div class="bg-green-50 p-4 rounded-lg border border-green-200"><p class="font-mono text-sm text-green-800">"Professor, que legal! As analogias ajudam demais! Mas... e quando voc√™ falou de 'desvio √† esquerda', o que √© isso?"</p></div></div>
                    <div id="step-4" class="step-content"><h4 class="text-2xl font-bold mb-4">Fase 4: Revis√£o e Aprofundamento</h4><p class="text-gray-700 mb-4">O utilizador √© for√ßado a refinar a sua explica√ß√£o. O Gem refraseia para confirmar o entendimento.</p><div class="bg-purple-50 p-4 rounded-lg border border-purple-200"><p class="font-mono text-sm text-purple-800">"Ah, perfeito! Ent√£o, o 'desvio √† esquerda' √© como um sinal de alarme. √â isso mesmo?"</p></div></div>
                    <div id="step-5" class="step-content"><h4 class="text-2xl font-bold mb-4">Fase 5: Consolida√ß√£o e Encerramento</h4><p class="text-gray-700 mb-4">O Gem incentiva o utilizador a recitar a explica√ß√£o completa e refinada para memoriza√ß√£o a longo prazo.</p><div class="bg-gray-100 p-4 rounded-lg border border-gray-200"><p class="font-mono text-sm text-gray-800">"Sinto que agora entendo mesmo! Que tal dar a aula completa de novo, do in√≠cio ao fim?"</p></div></div>
                </div>
            </div>
        </section>

        <!-- Section 3: Professor's Assistant -->
        <section id="assistente" class="mb-24 scroll-mt-24">
            <h3 class="text-3xl font-bold text-center mb-2">‚ú® Assistente do Professor</h3>
            <p class="text-center text-gray-600 mb-12">Ficou bloqueado? Use a IA para o ajudar a refinar os seus pensamentos antes de os ensinar.</p>
            <div class="max-w-3xl mx-auto bg-white p-8 rounded-lg shadow-md border border-gray-200">
                <label for="assistant-input" class="block text-lg font-medium text-gray-700 mb-2">Insira o seu conceito ou explica√ß√£o aqui:</label>
                <textarea id="assistant-input" rows="4" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#D35400] focus:border-[#D35400]" placeholder="Ex: A mitoc√¥ndria √© a casa de for√ßa da c√©lula..."></textarea>
                <div class="flex flex-col sm:flex-row gap-4 mt-4">
                    <button id="simplify-btn" class="flex-1 bg-[#D35400] text-white font-bold py-2 px-4 rounded-lg hover:bg-[#E67E22] transition shadow-md">‚ú® Simplificar Conceito</button>
                    <button id="generate-questions-btn" class="flex-1 bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 transition shadow-md">‚ú® Gerar Perguntas</button>
                </div>
                <div id="assistant-output" class="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200 min-h-[100px]">
                    <p class="text-gray-500">Os resultados aparecer√£o aqui...</p>
                </div>
            </div>
        </section>

        <!-- Section 4: Live Simulator -->
        <section id="simulador" class="scroll-mt-24">
            <h3 class="text-3xl font-bold text-center mb-2">Simulador de Di√°logo ao Vivo</h3>
            <p class="text-center text-gray-600 mb-12">Assuma o papel de "Professor". Ensine um conceito √† IA e veja como ela responde em tempo real.</p>
            <div class="max-w-3xl mx-auto">
                <div id="chat-window" class="bg-white rounded-t-lg shadow-lg border border-gray-200 p-4 h-96 overflow-y-auto space-y-4">
                    <!-- As mensagens do chat ser√£o adicionadas aqui -->
                </div>
                <div class="bg-white rounded-b-lg shadow-lg border-t-0 border border-gray-200 p-4">
                    <form id="chat-form" class="flex gap-4">
                        <input type="text" id="chat-input" class="flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-[#D35400] focus:border-[#D35400]" placeholder="Comece a ensinar..." autocomplete="off" disabled>
                        <button type="submit" id="chat-submit-btn" class="bg-[#D35400] text-white font-bold py-2 px-6 rounded-lg hover:bg-[#E67E22] transition shadow-md" disabled>Enviar</button>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-100 border-t border-gray-200 mt-24">
        <div class="container mx-auto px-6 py-8 text-center text-gray-500">
            <p>Guia Interativo baseado no "Relat√≥rio de Design Detalhado: Constru√ß√£o do Gem 'Aprendiz de Feynman'".</p>
            <p class="text-sm mt-2">Uma aplica√ß√£o para explorar a intersec√ß√£o da pedagogia e da IA.</p>
        </div>
    </footer>

<script>
    // --- L√ìGICA DE NAVEGA√á√ÉO E UI (SEM ALTERA√á√ïES) ---
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.nav-link');
    window.addEventListener('scroll', () => {
        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            if (pageYOffset >= sectionTop - 80) { current = section.getAttribute('id'); }
        });
        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href').includes(current)) { link.classList.add('active'); }
        });
    });
    const steps = document.querySelectorAll('.step');
    const stepContents = document.querySelectorAll('.step-content');
    function showStep(stepNumber) {
        steps.forEach(step => step.classList.remove('active'));
        stepContents.forEach(content => content.classList.remove('active'));
        document.querySelector(`.step:nth-child(${stepNumber})`).classList.add('active');
        document.getElementById(`step-${stepNumber}`).classList.add('active');
    }

    // --- L√ìGICA DA API DO GEMINI E INTERA√á√ïES ---

    const functionUrl = '/.netlify/functions/call-gemini'; // URL para a nossa fun√ß√£o segura

    // --- Assistente do Professor ---
    const assistantInput = document.getElementById('assistant-input');
    const simplifyBtn = document.getElementById('simplify-btn');
    const generateQuestionsBtn = document.getElementById('generate-questions-btn');
    const assistantOutput = document.getElementById('assistant-output');

    async function callAssistant(type, text) {
        assistantOutput.innerHTML = `<p class="text-gray-500">A processar o seu pedido... ‚ú®</p>`;
        try {
            const response = await fetch(functionUrl, {
                method: 'POST',
                body: JSON.stringify({ type: type, text: text })
            });
            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`A fun√ß√£o da Netlify retornou um erro: ${errorText}`);
            }
            const result = await response.text();
            assistantOutput.innerHTML = `<p>${result.replace(/\n/g, '<br>')}</p>`;
        } catch (error) {
            console.error("Erro ao chamar o assistente:", error);
            assistantOutput.innerHTML = `<p class="text-red-500">Ocorreu um erro. Verifique a consola (F12) para mais detalhes.</p>`;
        }
    }

    simplifyBtn.addEventListener('click', () => {
        const inputText = assistantInput.value.trim();
        if (!inputText) {
            assistantOutput.innerHTML = '<p class="text-red-500">Por favor, insira um conceito para simplificar.</p>';
            return;
        }
        callAssistant('simplify', inputText);
    });

    generateQuestionsBtn.addEventListener('click', () => {
        const inputText = assistantInput.value.trim();
        if (!inputText) {
            assistantOutput.innerHTML = '<p class="text-red-500">Por favor, insira uma explica√ß√£o para gerar perguntas.</p>';
            return;
        }
        callAssistant('generate_questions', inputText);
    });

    // --- Simulador de Chat ao Vivo ---
    const chatForm = document.getElementById('chat-form');
    const chatInput = document.getElementById('chat-input');
    const chatSubmitBtn = document.getElementById('chat-submit-btn');
    const chatWindow = document.getElementById('chat-window');
    let conversationHistory = [];

    function appendMessage(sender, text) {
        const messageElement = document.createElement('div');
        const sanitizedText = text.replace(/</g, "&lt;").replace(/>/g, "&gt;"); // Medida de seguran√ßa simples
        if (sender === 'user') {
            messageElement.innerHTML = `
                <div class="flex items-start gap-3 justify-end">
                    <div class="bg-blue-100 p-3 rounded-lg text-gray-700 max-w-md">${sanitizedText}</div>
                    <span class="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold flex-shrink-0">P</span>
                </div>`;
        } else { // gemini
            messageElement.innerHTML = `
                <div class="flex items-start gap-3">
                    <span class="w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold flex-shrink-0">ü§ñ</span>
                    <div class="bg-orange-100 p-3 rounded-lg text-gray-700 max-w-md">${sanitizedText.replace(/\n/g, '<br>')}</div>
                </div>`;
        }
        chatWindow.appendChild(messageElement);
        chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function showTypingIndicator() {
        const typingElement = document.createElement('div');
        typingElement.id = 'typing-indicator';
        typingElement.classList.add('gemini-typing-indicator');
        typingElement.innerHTML = `
            <div class="flex items-start gap-3">
                <span class="w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold flex-shrink-0">ü§ñ</span>
                <div class="bg-orange-100 p-3 rounded-lg"><div class="flex space-x-1"><span></span><span></span><span></span></div></div>
            </div>`;
        chatWindow.appendChild(typingElement);
        chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    function removeTypingIndicator() {
        const typingElement = document.getElementById('typing-indicator');
        if (typingElement) typingElement.remove();
    }
    
    function setChatState(enabled, message) {
        chatInput.disabled = !enabled;
        chatSubmitBtn.disabled = !enabled;
        chatInput.placeholder = message;
    }

    // Mensagem inicial do chat
    appendMessage('gemini', 'Ol√°, Professor! Que conceito fascinante vamos explorar hoje?');
    setChatState(true, 'Comece a ensinar...');

    chatForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const userInput = chatInput.value.trim();
        if (!userInput) return;

        appendMessage('user', userInput);
        conversationHistory.push({ role: "user", parts: [{ text: userInput }] });
        setChatState(false, 'A pensar...');
        showTypingIndicator();

        try {
            const response = await fetch(functionUrl, {
                method: 'POST',
                body: JSON.stringify({ type: 'chat', history: conversationHistory })
            });
            
            removeTypingIndicator();

            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`A fun√ß√£o da Netlify retornou um erro: ${errorText}`);
            }

            const geminiResponse = await response.text();
            appendMessage('gemini', geminiResponse);
            conversationHistory.push({ role: "model", parts: [{ text: geminiResponse }] });
            setChatState(true, 'Responda ou continue a ensinar...');

        } catch (error) {
            removeTypingIndicator();
            console.error("Erro ao chamar a fun√ß√£o de chat:", error);
            appendMessage('gemini', "Desculpe, ocorreu um erro. Verifique a consola (F12) para mais detalhes.");
            setChatState(true, 'Tente novamente...');
        } finally {
            chatInput.value = '';
        }
    });
</script>

</body>
</html>
